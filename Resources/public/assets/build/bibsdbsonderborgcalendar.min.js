/**
 * @name BibsdbSonderborgCalendarBundle
 * @version vdev
 * @link https://github.com/bibsdb/sonderborg-calendar-bundle
 */
angular.module("toolsModule").directive("sonderborgCalendarDisplayitems",function(){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&"},templateUrl:"/bundles/bibsdbsonderborgcalendar/apps/toolsModule/sonderborg-calendar-displayitems.html"}}),angular.module("toolsModule").directive("sonderborgCalendarEditor",function(){return{restrict:"E",replace:!0,scope:{slide:"=",close:"&"},link:function(l){function t(){l.newEvent={title:null,place:null,from:null,to:null,dateheaders:null,displaytime:null}}t(),l.newEventItem=function(){console.log("new");var e=l.setCalcProp(angular.copy(l.newEvent));l.slide.options.eventitems.push(e),t()},l.removeEventItem=function(e){l.slide.options.eventitems.splice(l.slide.options.eventitems.indexOf(e),1)},l.setDefaultDate=function(){var e=angular.element("#new-event-from").val();angular.element("#new-event-to").val();e&&angular.element("#new-event-to").datetimepicker({startDate:e,minDate:e})},l.setCalcProp=function(e){if(e.from&&e.to){e.dateheaders=[];for(var t=moment.unix(e.from).startOf("day");t<=moment.unix(e.to);)e.dateheaders.push(t.unix()),t.add(1,"d");e.displaytime=moment.unix(e.from).format("HH:mm")+moment.unix(e.to).format("[ - ] HH:mm")}else if(e.from){e.displaytime=moment.unix(e.from).format("HH:mm");t=moment.unix(e.from).startOf("day");e.dateheaders=[t.unix()]}return console.log(e),e},l.createEventHeaders=function(){for(var e=l.slide.options.eventitems,t=[],n=0;n<e.length;n++){var o=e[n];o&&o.dateheaders&&(t=t.concat(o.dateheaders))}var r={};t.forEach(function(e){r[e]||(r[e]=!0)});var a=Object.keys(r).sort(function(e,t){return e-t});l.slide.options.headers=a},l.eventIsOutdated=function(e){var t=e.to,n=e.from,o=Date.now()/1e3;return t&&t<o||!t&&n<o}},templateUrl:"/bundles/bibsdbsonderborgcalendar/apps/toolsModule/sonderborg-calendar-editor.html"}});